<!doctype html>




<html class="theme-next pisces" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="NjP189VhFlmwjqBiqOeGB6U7MJXKXL9W0mO_oqF9rKY" />










  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="tensorflow,deeplearning,ithome鐵人," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="今日目標
了解 Denoising Autoencoder
訓練 Denoising Autoencoder
測試不同輸入情形下的 Denoising Autoencoder 表現">
<meta property="og:type" content="article">
<meta property="og:title" content="Tensorflow Day19 Denoising Autoencoder">
<meta property="og:url" content="https://blog.c1mone.com.tw/tensorflow-note-day-19.html">
<meta property="og:site_name" content="94 讀書筆記咩">
<meta property="og:description" content="今日目標
了解 Denoising Autoencoder
訓練 Denoising Autoencoder
測試不同輸入情形下的 Denoising Autoencoder 表現">
<meta property="og:image" content="http://imgur.com/cG4Z37Y.jpg">
<meta property="og:image" content="http://imgur.com/7Egc9Np.jpg">
<meta property="og:image" content="http://imgur.com/wzLVgmV.jpg">
<meta property="og:image" content="http://imgur.com/C2UZGgN.jpg">
<meta property="og:image" content="http://imgur.com/RzHXKMa.jpg">
<meta property="og:image" content="http://imgur.com/xcivBWd.jpg">
<meta property="og:image" content="http://imgur.com/7vkovLS.jpg">
<meta property="og:image" content="http://imgur.com/4p6w4ij.jpg">
<meta property="og:image" content="http://imgur.com/Iy5Mrow.jpg">
<meta property="og:image" content="http://imgur.com/e6tfPFe.jpg">
<meta property="og:updated_time" content="2017-06-24T13:59:00.021Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tensorflow Day19 Denoising Autoencoder">
<meta name="twitter:description" content="今日目標
了解 Denoising Autoencoder
訓練 Denoising Autoencoder
測試不同輸入情形下的 Denoising Autoencoder 表現">
<meta name="twitter:image" content="http://imgur.com/cG4Z37Y.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: false,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.c1mone.com.tw/tensorflow-note-day-19.html"/>





  <title> Tensorflow Day19 Denoising Autoencoder | 94 讀書筆記咩 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-101607299-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">94 讀書筆記咩</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">全棧數據工程師之路迢迢</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://blog.c1mone.com.tw/tensorflow-note-day-19.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="c1mone">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="https://avatars2.githubusercontent.com/u/4519639?v=3&s=400.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="94 讀書筆記咩">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="94 讀書筆記咩" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Tensorflow Day19 Denoising Autoencoder
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-03T19:28:38+08:00">
                2017-01-03
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/tensorflow-note-day-19.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="tensorflow-note-day-19.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="今日目標"><a href="#今日目標" class="headerlink" title="今日目標"></a>今日目標</h2><ul>
<li>了解 Denoising Autoencoder</li>
<li>訓練 Denoising Autoencoder</li>
<li>測試不同輸入情形下的 Denoising Autoencoder 表現</li>
</ul>
<a id="more"></a>
<p><a href="https://github.com/c1mone/Tensorflow-101/blob/master/notebooks/8_Denoising_Autoencoder.ipynb" target="_blank" rel="external">Github Ipython Notebook 好讀完整版</a></p>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>什麼是 denoising 呢？意思就是把去除雜訊的意思，也就是說這裡的 autoencoder 有把輸入的雜訊去除的功能．例如輸入的圖像不是一個乾淨的圖像而是有許多的白點或破損 (也就是噪音)，那這個網路還有辦法辨認出輸入圖像是什麼數字，就被稱為 <code>Denoising Autoencoder</code>．</p>
<p>那要如何訓練 denoising autoencoder 呢? 很簡單的只要輸入一個人工加上的噪音影像，然後 loss 為 autoencoder 輸出的影像和原始影像的<strong>誤差</strong>，並最小化這個誤差，其所輸出的神經網路就可以完成<strong>去噪</strong>的功能．</p>
<p>以下會用一個 convolutional 的網路結構來完成一個 denoising autoencoder．並用 MNIST 的資料來訓練之．</p>
<h2 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a>Implementation</h2><h3 id="Build-helper-functions"><a href="#Build-helper-functions" class="headerlink" title="Build helper functions"></a>Build helper functions</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">conv2d</span><span class="params">(x, W)</span>:</span></div><div class="line">    <span class="keyword">return</span> tf.nn.conv2d(x, W, strides=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>], padding = <span class="string">'SAME'</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">deconv2d</span><span class="params">(x, W, output_shape)</span>:</span></div><div class="line">    <span class="keyword">return</span> tf.nn.conv2d_transpose(x, W, output_shape, strides = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>], padding = <span class="string">'SAME'</span>)</div></pre></td></tr></table></figure>
<h3 id="Build-compute-graph"><a href="#Build-compute-graph" class="headerlink" title="Build compute graph"></a>Build compute graph</h3><p>注意到這裡建立了兩個 <code>placeholder</code>，一個是原始影像 <code>x</code>，另一個是雜訊影像 <code>x_noise</code>，而輸入到網路裡面的是 <code>x_noise</code>．</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_graph</span><span class="params">()</span>:</span></div><div class="line">    x_origin = tf.reshape(x, [<span class="number">-1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>])</div><div class="line">    x_origin_noise = tf.reshape(x_noise, [<span class="number">-1</span>, <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>])</div><div class="line"></div><div class="line">    W_e_conv1 = weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">16</span>], <span class="string">"w_e_conv1"</span>)</div><div class="line">    b_e_conv1 = bias_variable([<span class="number">16</span>], <span class="string">"b_e_conv1"</span>)</div><div class="line">    h_e_conv1 = tf.nn.relu(tf.add(conv2d(x_origin_noise, W_e_conv1), b_e_conv1))</div><div class="line"></div><div class="line">    W_e_conv2 = weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">16</span>, <span class="number">32</span>], <span class="string">"w_e_conv2"</span>)</div><div class="line">    b_e_conv2 = bias_variable([<span class="number">32</span>], <span class="string">"b_e_conv2"</span>)</div><div class="line">    h_e_conv2 = tf.nn.relu(tf.add(conv2d(h_e_conv1, W_e_conv2), b_e_conv2))</div><div class="line"></div><div class="line">    code_layer = h_e_conv2</div><div class="line">    print(<span class="string">"code layer shape : %s"</span> % h_e_conv2.get_shape())</div><div class="line"></div><div class="line">    W_d_conv1 = weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">16</span>, <span class="number">32</span>], <span class="string">"w_d_conv1"</span>)</div><div class="line">    b_d_conv1 = bias_variable([<span class="number">1</span>], <span class="string">"b_d_conv1"</span>)</div><div class="line">    output_shape_d_conv1 = tf.pack([tf.shape(x)[<span class="number">0</span>], <span class="number">14</span>, <span class="number">14</span>, <span class="number">16</span>])</div><div class="line">    h_d_conv1 = tf.nn.relu(deconv2d(h_e_conv2, W_d_conv1, output_shape_d_conv1))</div><div class="line"></div><div class="line">    W_d_conv2 = weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">16</span>], <span class="string">"w_d_conv2"</span>)</div><div class="line">    b_d_conv2 = bias_variable([<span class="number">16</span>], <span class="string">"b_d_conv2"</span>)</div><div class="line">    output_shape_d_conv2 = tf.pack([tf.shape(x)[<span class="number">0</span>], <span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>])</div><div class="line">    h_d_conv2 = tf.nn.relu(deconv2d(h_d_conv1, W_d_conv2, output_shape_d_conv2))</div><div class="line"></div><div class="line">    x_reconstruct = h_d_conv2</div><div class="line">    print(<span class="string">"reconstruct layer shape : %s"</span> % x_reconstruct.get_shape())</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> x_origin, code_layer, x_reconstruct</div><div class="line"></div><div class="line">tf.reset_default_graph()</div><div class="line">x = tf.placeholder(tf.float32, shape = [<span class="keyword">None</span>, <span class="number">784</span>])</div><div class="line">x_noise = tf.placeholder(tf.float32, shape = [<span class="keyword">None</span>, <span class="number">784</span>])</div><div class="line">x_origin, code_layer, x_reconstruct = build_graph()</div></pre></td></tr></table></figure>
<h3 id="Build-cost-function"><a href="#Build-cost-function" class="headerlink" title="Build cost function"></a>Build cost function</h3><p>在 cost function 裡面計算 cost 的方式是計算輸出影像和原始影像的 mean square error．</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cost = tf.reduce_mean(tf.pow(x_reconstruct - x_origin, <span class="number">2</span>))</div><div class="line">optimizer = tf.train.AdamOptimizer(<span class="number">0.01</span>).minimize(cost)</div></pre></td></tr></table></figure>
<h2 id="Training-Add-noise-with-coefficient-0-3"><a href="#Training-Add-noise-with-coefficient-0-3" class="headerlink" title="Training (Add noise with coefficient 0.3)"></a>Training (Add noise with coefficient 0.3)</h2><p>在訓練的過程中，輸入的噪音影像 (參數為 <code>0.3</code>)，並觀察 mean square error 的下降情形．</p>
<p>在測試的時候，輸入一個原始影像，看重建輸出的影響會和原始影像的 mean square error 是多少．</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">sess = tf.InteractiveSession()</div><div class="line">batch_size = <span class="number">50</span></div><div class="line">init_op = tf.global_variables_initializer()</div><div class="line">sess.run(init_op)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> range(<span class="number">10000</span>):</div><div class="line">    batch = mnist.train.next_batch(batch_size)</div><div class="line">    batch_raw = batch[<span class="number">0</span>]</div><div class="line">    batch_noise = batch[<span class="number">0</span>] + <span class="number">0.3</span>*np.random.randn(batch_size, <span class="number">784</span>)</div><div class="line">    <span class="keyword">if</span> epoch &lt; <span class="number">1500</span>:</div><div class="line">        <span class="keyword">if</span> epoch%<span class="number">100</span> == <span class="number">0</span>:</div><div class="line">            print(<span class="string">"step %d, loss %g"</span>%(epoch, cost.eval(feed_dict=&#123;x:batch_raw, x_noise: batch_noise&#125;)))</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">if</span> epoch%<span class="number">1000</span> == <span class="number">0</span>: </div><div class="line">            print(<span class="string">"step %d, loss %g"</span>%(epoch, cost.eval(feed_dict=&#123;x:batch_raw, x_noise: batch_noise&#125;)))</div><div class="line">    </div><div class="line">    optimizer.run(feed_dict=&#123;x:batch_raw, x_noise: batch_noise&#125;)</div><div class="line">    </div><div class="line">print(<span class="string">"final loss %g"</span> % cost.eval(feed_dict=&#123;x: mnist.test.images, x_noise: mnist.test.images&#125;))</div></pre></td></tr></table></figure>
<pre><code>step 0, loss 0.112669
step 100, loss 0.040153
step 200, loss 0.0327908
step 300, loss 0.035064
step 400, loss 0.0333917
step 500, loss 0.0303075
step 600, loss 0.0353892
step 700, loss 0.0350619
step 800, loss 0.0328716
step 900, loss 0.0291624
step 1000, loss 0.034999
step 1100, loss 0.0368471
step 1200, loss 0.0339421
step 1300, loss 0.0329562
step 1400, loss 0.0305635
step 2000, loss 0.0319757
step 3000, loss 0.0340622
step 4000, loss 0.0306117
step 5000, loss 0.0317413
step 6000, loss 0.0297122
step 7000, loss 0.0349187
step 8000, loss 0.00620675
step 9000, loss 0.00623596
final loss 0.0024923
</code></pre><h3 id="Plot-reconstructed-images"><a href="#Plot-reconstructed-images" class="headerlink" title="Plot reconstructed images"></a>Plot reconstructed images</h3><p>使用沒有在訓練過程中的測試噪音影像，觀察經過網路去噪之後的結果．</p>
<h3 id="Reconstructed-images-with-coefficient-0-3"><a href="#Reconstructed-images-with-coefficient-0-3" class="headerlink" title="Reconstructed images with coefficient 0.3"></a>Reconstructed images with coefficient 0.3</h3><p>結果很不錯</p>
<p><img src="http://imgur.com/cG4Z37Y.jpg" alt="png"></p>
<h3 id="Reconstructed-images-with-coefficient-0-5"><a href="#Reconstructed-images-with-coefficient-0-5" class="headerlink" title="Reconstructed images with coefficient 0.5"></a>Reconstructed images with coefficient 0.5</h3><p>結果已經有點變得模糊</p>
<p><img src="http://imgur.com/7Egc9Np.jpg" alt="png"></p>
<h3 id="Reconstructed-images-with-coefficient-0-7"><a href="#Reconstructed-images-with-coefficient-0-7" class="headerlink" title="Reconstructed images with coefficient 0.7"></a>Reconstructed images with coefficient 0.7</h3><p>已經快變認不出來了</p>
<p><img src="http://imgur.com/wzLVgmV.jpg" alt="png"></p>
<h3 id="Reconstructed-images-with-coefficient-0-9"><a href="#Reconstructed-images-with-coefficient-0-9" class="headerlink" title="Reconstructed images with coefficient 0.9"></a>Reconstructed images with coefficient 0.9</h3><p>勉勉強強有一些紋路．</p>
<p><img src="http://imgur.com/C2UZGgN.jpg" alt="png"></p>
<h3 id="Plot-code-layer-result"><a href="#Plot-code-layer-result" class="headerlink" title="Plot code layer result"></a>Plot code layer result</h3><p>觀察中間的 code layer 的結果．</p>
<p><img src="http://imgur.com/RzHXKMa.jpg" alt="png"></p>
<p>可以看到是部分的 filter 有反應，而反應的 filter 也是模模糊糊的影像，但這樣的輸出經過 decoder 卻可以很漂亮的重建回原來影像．</p>
<h2 id="Trainging-Add-noise-with-coefficient-0-8"><a href="#Trainging-Add-noise-with-coefficient-0-8" class="headerlink" title="Trainging (Add noise with coefficient 0.8)"></a>Trainging (Add noise with coefficient 0.8)</h2><p>接下來我們想要挑戰比較困難的使用更模糊的影像來訓練神經網路看看它的結果如何．</p>
<pre><code>step 0, loss 0.112311
step 100, loss 0.0289463
step 200, loss 0.0289349
step 300, loss 0.0273639
step 400, loss 0.0275356
step 500, loss 0.0253755
step 600, loss 0.0251334
step 700, loss 0.027199
step 800, loss 0.0272284
step 900, loss 0.0243694
step 1000, loss 0.0256118
step 1100, loss 0.025205
step 1200, loss 0.0246229
step 1300, loss 0.0241241
step 1400, loss 0.0257103
step 2000, loss 0.0247174
step 3000, loss 0.0235407
step 4000, loss 0.026623
step 5000, loss 0.0257211
step 6000, loss 0.0246029
step 7000, loss 0.0241382
step 8000, loss 0.0238624
step 9000, loss 0.0230421
final loss 0.0111788
</code></pre><h3 id="Reconstructed-images-with-coefficient-0-5-1"><a href="#Reconstructed-images-with-coefficient-0-5-1" class="headerlink" title="Reconstructed images with coefficient 0.5"></a>Reconstructed images with coefficient 0.5</h3><p>可以看到重建的結果很好．</p>
<p><img src="http://imgur.com/xcivBWd.jpg" alt="png"></p>
<h3 id="Reconstructed-images-with-coefficient-0-8"><a href="#Reconstructed-images-with-coefficient-0-8" class="headerlink" title="Reconstructed images with coefficient 0.8"></a>Reconstructed images with coefficient 0.8</h3><p>在係數為 0.8 的情形下，重建出來的影像結果比用 0.3 訓練出來的網路優秀，但是已經開始有些模糊．</p>
<p><img src="http://imgur.com/7vkovLS.jpg" alt="png"></p>
<h3 id="Reconstructed-images-with-coefficient-0-9-1"><a href="#Reconstructed-images-with-coefficient-0-9-1" class="headerlink" title="Reconstructed images with coefficient 0.9"></a>Reconstructed images with coefficient 0.9</h3><p>一些數字仍然可以辨認，但有一些變得較糊．</p>
<p><img src="http://imgur.com/4p6w4ij.jpg" alt="png"></p>
<h3 id="Reconstructed-images-with-coefficient-1-0"><a href="#Reconstructed-images-with-coefficient-1-0" class="headerlink" title="Reconstructed images with coefficient 1.0"></a>Reconstructed images with coefficient 1.0</h3><p>只剩下少數的可以辨認．</p>
<p><img src="http://imgur.com/Iy5Mrow.jpg" alt="png"></p>
<h3 id="Plot-code-layer-result-1"><a href="#Plot-code-layer-result-1" class="headerlink" title="Plot code layer result"></a>Plot code layer result</h3><p>一樣是少許的 filter 會有結果</p>
<p><img src="http://imgur.com/e6tfPFe.jpg" alt=""></p>
<h2 id="今日心得"><a href="#今日心得" class="headerlink" title="今日心得"></a>今日心得</h2><p>實作了 <code>Denoising Autoencoder</code>，並用不同強度的雜訊來測試，其效果就視覺上看起來還算不錯．</p>
<p>而如果加強了雜訊的強度，期訓練出來的 autoencoder 抗噪的能力也會更好!</p>
<h3 id="問題"><a href="#問題" class="headerlink" title="問題"></a>問題</h3><ul>
<li>用普通的 autoencoder 來實作，其結果和 convolutional autoencoder 的比較．</li>
<li>如果不是輸入噪音影像，而是輸入三分之一，或是四分之一的影像，不知道可不可以還原回來?</li>
</ul>
<h2 id="學習資源連結"><a href="#學習資源連結" class="headerlink" title="學習資源連結"></a>學習資源連結</h2><p><a href="https://github.com/sjchoi86/tensorflow-101/blob/master/notebooks/dae_mnist_dropout.ipynb" target="_blank" rel="external">Github Denoising Autoencoder example</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/tensorflow/" rel="tag"># tensorflow</a>
          
            <a href="/tags/deeplearning/" rel="tag"># deeplearning</a>
          
            <a href="/tags/ithome鐵人/" rel="tag"># ithome鐵人</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/tensorflow-note-day-18.html" rel="next" title="Tensorflow Day18 Convolutional Autoencoder">
                <i class="fa fa-chevron-left"></i> Tensorflow Day18 Convolutional Autoencoder
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/tensorflow-note-day-22.html" rel="prev" title="Tensorflow Day22 word2vec 介紹">
                Tensorflow Day22 word2vec 介紹 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://avatars2.githubusercontent.com/u/4519639?v=3&s=400.jpg"
               alt="c1mone" />
          <p class="site-author-name" itemprop="name">c1mone</p>
          <p class="site-description motion-element" itemprop="description">Be relentlessly resourceful．</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">30</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="http://github.com/c1mone" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#今日目標"><span class="nav-number">1.</span> <span class="nav-text">今日目標</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Introduction"><span class="nav-number">2.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Implementation"><span class="nav-number">3.</span> <span class="nav-text">Implementation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Build-helper-functions"><span class="nav-number">3.1.</span> <span class="nav-text">Build helper functions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Build-compute-graph"><span class="nav-number">3.2.</span> <span class="nav-text">Build compute graph</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Build-cost-function"><span class="nav-number">3.3.</span> <span class="nav-text">Build cost function</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Training-Add-noise-with-coefficient-0-3"><span class="nav-number">4.</span> <span class="nav-text">Training (Add noise with coefficient 0.3)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Plot-reconstructed-images"><span class="nav-number">4.1.</span> <span class="nav-text">Plot reconstructed images</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reconstructed-images-with-coefficient-0-3"><span class="nav-number">4.2.</span> <span class="nav-text">Reconstructed images with coefficient 0.3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reconstructed-images-with-coefficient-0-5"><span class="nav-number">4.3.</span> <span class="nav-text">Reconstructed images with coefficient 0.5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reconstructed-images-with-coefficient-0-7"><span class="nav-number">4.4.</span> <span class="nav-text">Reconstructed images with coefficient 0.7</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reconstructed-images-with-coefficient-0-9"><span class="nav-number">4.5.</span> <span class="nav-text">Reconstructed images with coefficient 0.9</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Plot-code-layer-result"><span class="nav-number">4.6.</span> <span class="nav-text">Plot code layer result</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Trainging-Add-noise-with-coefficient-0-8"><span class="nav-number">5.</span> <span class="nav-text">Trainging (Add noise with coefficient 0.8)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Reconstructed-images-with-coefficient-0-5-1"><span class="nav-number">5.1.</span> <span class="nav-text">Reconstructed images with coefficient 0.5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reconstructed-images-with-coefficient-0-8"><span class="nav-number">5.2.</span> <span class="nav-text">Reconstructed images with coefficient 0.8</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reconstructed-images-with-coefficient-0-9-1"><span class="nav-number">5.3.</span> <span class="nav-text">Reconstructed images with coefficient 0.9</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reconstructed-images-with-coefficient-1-0"><span class="nav-number">5.4.</span> <span class="nav-text">Reconstructed images with coefficient 1.0</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Plot-code-layer-result-1"><span class="nav-number">5.5.</span> <span class="nav-text">Plot code layer result</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#今日心得"><span class="nav-number">6.</span> <span class="nav-text">今日心得</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#問題"><span class="nav-number">6.1.</span> <span class="nav-text">問題</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#學習資源連結"><span class="nav-number">7.</span> <span class="nav-text">學習資源連結</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">c1mone</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'c1mone';
      var disqus_identifier = 'tensorflow-note-day-19.html';

      var disqus_title = "Tensorflow Day19 Denoising Autoencoder";


      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      
        var disqus_config = function () {
            this.page.url = disqus_url;
            this.page.identifier = disqus_identifier;
            this.page.title = disqus_title;
        };
        run_disqus_script('embed.js');
      

    </script>
  





  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

  


</body>
</html>
